import React, { useState, useEffect } from 'react';
import { Search, Bell, User, Menu, Plus } from 'lucide-react';
import { Button } from '@/components/primitives/button'; export interface TopMenuBarProps { currentUser?: any; currentPage?: string; onLogout?: () => void; onNavigate?: (page: any, problemId?: string) => void; onQueryChange?: (query: string) => void; onSearchSubmit?: () => void; onMenuClick?: () => void; onNotificationClick?: () => void; searchQuery?: string;
} const SearchInput = ({ value, onChange, onKeyDown, }: { value: string; onChange: (e: React.ChangeEvent<HTMLInputElement>) => void; onKeyDown: (e: React.KeyboardEvent<HTMLInputElement>) => void; ?: string;
}) => ( <div> <Search /> <input type="text" value={value} placeholder="問題を検索..." style={{ paddingTop: "0.5rem", paddingBottom: "0.5rem" }} onChange={onChange} onKeyDown={onKeyDown} /> </div>
); export default function TopMenuBar({ currentUser, onLogout, onNavigate, onQueryChange, onSearchSubmit, onMenuClick, onNotificationClick, searchQuery = }: TopMenuBarProps) { const user = currentUser; const [localQuery, setLocalQuery] = useState(searchQuery); useEffect(() => { setLocalQuery(searchQuery); }, [searchQuery]); const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => { const val = e.target.value; setLocalQuery(val); onQueryChange?.(val); }; const handleKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => { if (e.key === 'Enter') { onSearchSubmit?.(); } }; return ( <nav> <div style={{ paddingLeft: "1rem", paddingRight: "1rem" }> {/* Main Nav Row */} <div style={{ display: undefined, alignItems: "center" }> {/* Left Section: Hamburger & Logo */} <div style={{ display: undefined, alignItems: "center", gap: "0.5rem" }> <Button variant="ghost" size="icon" title="メニュー" data-trigger="menu-button" onClick={onMenuClick}> <Menu /> </Button> <div onClick={() => onNavigate?.('home')}> <span> Edumint </span> </div> </div> {/* Center Section: Search (Desktop only) */} <div style={{ justifyContent: "center" }> <SearchInput value={localQuery} onChange={handleInputChange} onKeyDown={handleKeyDown} /> </div> {/* Right Section: Actions */} <div style={{ display: undefined, alignItems: "center", gap: "0.25rem" }> <Button variant="ghost" size="icon" onClick={() => onNavigate?.()} title="問題をアップロード"> <Plus /> </Button> <Button variant="ghost" size="icon" data-trigger="notification-bell" onClick={onNotificationClick}> <Bell /> </Button> <div style={{ display: undefined, alignItems: "center", gap: "0.5rem" }> <div> <div> {user?.username || 'ゲストユーザー'} </div> </div> <Button variant="ghost" size="icon" onClick={() => onNavigate?.('my-page')}> <User /> </Button> </div> </div> </div> {/* Mobile Search Row (visible only on small screens) */} <div> <SearchInput value={localQuery} onChange={handleInputChange} onKeyDown={handleKeyDown} /> </div> </div> </nav> );
} // named export for testing compatibility
export { TopMenuBar };
